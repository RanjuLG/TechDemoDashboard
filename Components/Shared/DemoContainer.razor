@namespace TechDemoDashboard.Components.Shared

<div class="card">
    <div class="card-header d-flex align-items-center justify-content-between">
        <h3 class="h6 mb-0 fw-bold">@Title</h3>
        @if (IsBusy)
        {
            <div class="spinner-border spinner-border-sm text-primary-custom" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        }
    </div>
    
    <div class="card-body p-0">
        <div class="log-output p-3" @ref="logOutputRef">
            @if (!_logLines.Any())
            {
                <div class="text-muted text-center py-4">No logs yet. Run a demo to see output here.</div>
            }
            else
            {
                @foreach (var line in _logLines)
                {
                    <div class="log-line">@line</div>
                }
            }
        </div>
    </div>
</div>

@code {
    [Parameter]
    public string Title { get; set; } = "Demo";

    [Parameter]
    public bool IsBusy { get; set; }

    private ElementReference logOutputRef;
    private List<string> _logLines = new();

    /// <summary>
    /// Adds a message to the log output window.
    /// Call this from parent components using @ref.
    /// </summary>
    public void Log(string message)
    {
        _logLines.Add($"[{DateTime.Now:HH:mm:ss.fff}] {message}");
        StateHasChanged();
    }

    /// <summary>
    /// Clears all log messages.
    /// </summary>
    public void Clear()
    {
        _logLines.Clear();
        StateHasChanged();
    }
}

<style>
    .log-output {
        background-color: rgba(0, 0, 0, 0.4);
        color: var(--primary-color);
        font-family: 'Consolas', 'Courier New', monospace;
        font-size: 0.85rem;
        min-height: 200px;
        max-height: 400px;
        overflow-y: auto;
        border-radius: 0 0 8px 8px;
    }

    .log-line {
        margin-bottom: 0.25rem;
        line-height: 1.5;
        padding: 0.125rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.03);
    }

    .log-line:last-child {
        border-bottom: none;
    }
</style>
